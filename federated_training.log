2026-01-06 06:50:13.565357: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
`torch_dtype` is deprecated! Use `dtype` instead!

======================================================================
ğŸš€ FEDERATED TRAINING - MILESTONE 7
======================================================================

âš™ï¸  Configuration:
   Clients: 3
   Rounds: 5
   Local Steps: 100
   Batch Size: 2
   Learning Rate: 0.0002
   Samples/Client: 5000
   GPU: 3

======================================================================
ğŸ”§ INITIALIZING GLOBAL MODEL
======================================================================
ğŸ”„ Loading tokenizer: mistralai/Mistral-7B-Instruct-v0.2
ğŸ”„ Loading model with 4-bit quantization...
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–      | 1/3 [00:07<00:14,  7.21s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:14<00:07,  7.43s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:21<00:00,  6.97s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:21<00:00,  7.07s/it]
ğŸ”§ Setting up LoRA (r=8, alpha=16)...
âœ… LoRA adapters applied
ğŸ“Š Trainable params: 3,407,872 (0.09%)
ğŸ’¾ VRAM: 4.35 GB

======================================================================
ğŸ¥ INITIALIZING CLIENTS
======================================================================

ğŸ“‚ Loading hospital_A data from data/processed/hospital_A/dataset.jsonl
âœ… Loaded 4,520 samples for hospital_A
âœ… Client 'hospital_A' initialized
   - Samples: 4,520
   - Training steps: 100

ğŸ“‚ Loading hospital_B data from data/processed/hospital_B/dataset.jsonl
âœ… Loaded 2,521 samples for hospital_B
âœ… Client 'hospital_B' initialized
   - Samples: 2,521
   - Training steps: 100

ğŸ“‚ Loading hospital_C data from data/processed/hospital_C/dataset.jsonl
âœ… Loaded 2,959 samples for hospital_C
âœ… Client 'hospital_C' initialized
   - Samples: 2,959
   - Training steps: 100

âœ… Initialized 3 clients
ğŸ“Š Total samples: 10,000

======================================================================
ğŸ”„ ROUND 1/5
======================================================================

--- Client 1/3: hospital_A ---

============================================================
ğŸ¥ CLIENT: hospital_A
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 4520 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_A

Training:   0%|          | 0/100 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/root/miniconda/lib/python3.13/site-packages/torch/_dynamo/eval_frame.py:1044: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. Starting in PyTorch 2.9, calling checkpoint without use_reentrant will raise an exception. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Training:   1%|          | 1/100 [00:05<09:53,  5.99s/it]Training:   2%|â–         | 2/100 [00:11<09:32,  5.84s/it]Training:   3%|â–         | 3/100 [00:17<09:21,  5.79s/it]Training:   4%|â–         | 4/100 [00:23<09:14,  5.77s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:07,  5.76s/it]Training:   6%|â–Œ         | 6/100 [00:34<09:01,  5.76s/it]Training:   7%|â–‹         | 7/100 [00:40<08:55,  5.75s/it]Training:   8%|â–Š         | 8/100 [00:46<08:49,  5.75s/it]Training:   9%|â–‰         | 9/100 [00:51<08:42,  5.75s/it]Training:   9%|â–‰         | 9/100 [00:57<08:42,  5.75s/it, loss=3.2998, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:36,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:03<08:31,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:09<08:25,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:19,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:13,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:26<08:07,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:32<08:02,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:56,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:43<07:50,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:49<07:44,  5.74s/it, loss=3.2998, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:55<07:44,  5.74s/it, loss=0.3039, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:55<07:39,  5.74s/it, loss=0.3039, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:33,  5.74s/it, loss=0.3039, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:06<07:27,  5.74s/it, loss=0.3039, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:12<07:21,  5.73s/it, loss=0.3039, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:15,  5.73s/it, loss=0.3039, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:09,  5.73s/it, loss=0.3039, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:29<07:04,  5.73s/it, loss=0.3039, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:35<06:58,  5.74s/it, loss=0.3039, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:52,  5.73s/it, loss=0.3039, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:46<06:46,  5.73s/it, loss=0.3039, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:52<06:46,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:52<06:41,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:58<06:35,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:09<06:24,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:15<06:18,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:21<06:12,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:26<06:06,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:32<06:00,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:38<05:55,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:49,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:49<05:49,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:49<05:43,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:55<05:37,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:01<05:32,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:06<05:26,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:12<05:20,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:18<05:15,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:24<05:09,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:29<05:03,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:35<04:58,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:41<04:52,  5.73s/it, loss=0.1881, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:52,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:46,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:52<04:40,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:58<04:35,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:04<04:29,  5.74s/it, loss=0.2073, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:09<04:23,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:15<04:17,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:21<04:12,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:27<04:06,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:32<04:00,  5.73s/it, loss=0.2073, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:38<03:54,  5.72s/it, loss=0.2073, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:44<03:54,  5.72s/it, loss=0.1606, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:44<03:48,  5.72s/it, loss=0.1606, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:50<03:43,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:55<03:37,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:01<03:31,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:07<03:26,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:12<03:20,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:18<03:14,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:24<03:09,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:30<03:03,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:35<02:57,  5.73s/it, loss=0.1606, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:41<02:57,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:41<02:52,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:47<02:46,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:53<02:40,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:58<02:34,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:04<02:29,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:10<02:23,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:15<02:17,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:21<02:11,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:27<02:06,  5.73s/it, loss=0.2280, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:33<02:00,  5.74s/it, loss=0.2280, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:38<02:00,  5.74s/it, loss=0.2237, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:38<01:54,  5.74s/it, loss=0.2237, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:44<01:48,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:50<01:43,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:56<01:37,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:01<01:31,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:07<01:25,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:13<01:20,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:19<01:14,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:24<01:08,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:30<01:03,  5.73s/it, loss=0.2237, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:36<01:03,  5.73s/it, loss=0.1791, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:36<00:57,  5.73s/it, loss=0.1791, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:41<00:51,  5.73s/it, loss=0.1791, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:47<00:45,  5.73s/it, loss=0.1791, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:53<00:40,  5.73s/it, loss=0.1791, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:59<00:34,  5.74s/it, loss=0.1791, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:04<00:28,  5.74s/it, loss=0.1791, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:10<00:22,  5.74s/it, loss=0.1791, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:16<00:17,  5.74s/it, loss=0.1791, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:22<00:11,  5.75s/it, loss=0.1791, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:27<00:05,  5.74s/it, loss=0.1791, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:33<00:05,  5.74s/it, loss=0.2100, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:34<00:00,  5.95s/it, loss=0.2100, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:34<00:00,  5.74s/it, loss=0.2100, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_A/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 14.2294
ğŸ“‰ Final loss: 0.4380
ğŸ“‰ Loss reduction: 96.92%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_A/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 14.2294 â†’ 0.4380
   - Improvement: 96.92%
   - Samples: 4,520

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


--- Client 2/3: hospital_B ---

============================================================
ğŸ¥ CLIENT: hospital_B
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 2521 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_B

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:31,  5.78s/it]Training:   2%|â–         | 2/100 [00:11<09:26,  5.78s/it]Training:   3%|â–         | 3/100 [00:17<09:20,  5.78s/it]Training:   4%|â–         | 4/100 [00:23<09:14,  5.78s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:08,  5.77s/it]Training:   6%|â–Œ         | 6/100 [00:34<09:02,  5.77s/it]Training:   7%|â–‹         | 7/100 [00:40<08:55,  5.76s/it]Training:   8%|â–Š         | 8/100 [00:46<08:49,  5.76s/it]Training:   9%|â–‰         | 9/100 [00:51<08:43,  5.76s/it]Training:   9%|â–‰         | 9/100 [00:57<08:43,  5.76s/it, loss=2.7145, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:38,  5.76s/it, loss=2.7145, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:03<08:31,  5.75s/it, loss=2.7145, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:09<08:26,  5.75s/it, loss=2.7145, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:20,  5.75s/it, loss=2.7145, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:14,  5.75s/it, loss=2.7145, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:26<08:08,  5.75s/it, loss=2.7145, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:32<08:02,  5.75s/it, loss=2.7145, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:56,  5.74s/it, loss=2.7145, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:43<07:50,  5.74s/it, loss=2.7145, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:49<07:45,  5.74s/it, loss=2.7145, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:55<07:45,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:55<07:39,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:33,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:06<07:27,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:12<07:21,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:18<07:16,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:10,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:29<07:04,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:35<06:58,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:53,  5.74s/it, loss=0.2032, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:46<06:47,  5.73s/it, loss=0.2032, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:52<06:47,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:52<06:41,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:58<06:35,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:09<06:23,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:15<06:18,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:21<06:12,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:26<06:06,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:32<06:01,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:38<05:55,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:44<05:49,  5.73s/it, loss=0.2436, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:49<05:49,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:49<05:44,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:55<05:38,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:01<05:32,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:06<05:26,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:12<05:20,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:18<05:15,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:24<05:09,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:29<05:03,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:35<04:57,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:41<04:52,  5.73s/it, loss=0.1676, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:47<04:52,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:47<04:46,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:52<04:40,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:58<04:35,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:04<04:29,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:09<04:23,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:15<04:17,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:21<04:11,  5.72s/it, loss=0.2033, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:27<04:06,  5.72s/it, loss=0.2033, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:32<04:00,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:38<03:54,  5.73s/it, loss=0.2033, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:44<03:54,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:44<03:49,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:50<03:43,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:55<03:37,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:01<03:31,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:07<03:26,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:12<03:20,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:18<03:14,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:24<03:09,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:30<03:03,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:35<02:57,  5.73s/it, loss=0.1695, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:41<02:57,  5.73s/it, loss=0.1811, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:41<02:51,  5.73s/it, loss=0.1811, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:47<02:46,  5.73s/it, loss=0.1811, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:53<02:40,  5.74s/it, loss=0.1811, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:58<02:34,  5.74s/it, loss=0.1811, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:04<02:29,  5.74s/it, loss=0.1811, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:10<02:23,  5.74s/it, loss=0.1811, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:16<02:18,  5.76s/it, loss=0.1811, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:21<02:12,  5.75s/it, loss=0.1811, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:27<02:06,  5.75s/it, loss=0.1811, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:33<02:00,  5.75s/it, loss=0.1811, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:39<02:00,  5.75s/it, loss=0.2964, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:39<01:54,  5.75s/it, loss=0.2964, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:44<01:49,  5.74s/it, loss=0.2964, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:50<01:43,  5.74s/it, loss=0.2964, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:56<01:37,  5.75s/it, loss=0.2964, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:02<01:31,  5.75s/it, loss=0.2964, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:07<01:26,  5.75s/it, loss=0.2964, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:13<01:20,  5.75s/it, loss=0.2964, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:19<01:14,  5.74s/it, loss=0.2964, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:25<01:08,  5.74s/it, loss=0.2964, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:30<01:03,  5.73s/it, loss=0.2964, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:36<01:03,  5.73s/it, loss=0.1812, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:36<00:57,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:42<00:51,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:47<00:45,  5.73s/it, loss=0.1812, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:53<00:40,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:59<00:34,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:05<00:28,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:10<00:22,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:16<00:17,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:22<00:11,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:28<00:05,  5.74s/it, loss=0.1812, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:33<00:05,  5.74s/it, loss=0.2714, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:34<00:00,  5.96s/it, loss=0.2714, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:34<00:00,  5.75s/it, loss=0.2714, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_B/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 10.7935
ğŸ“‰ Final loss: 0.3786
ğŸ“‰ Loss reduction: 96.49%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_B/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 10.7935 â†’ 0.3786
   - Improvement: 96.49%
   - Samples: 2,521

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


--- Client 3/3: hospital_C ---

============================================================
ğŸ¥ CLIENT: hospital_C
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 2959 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_C

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:31,  5.77s/it]Training:   2%|â–         | 2/100 [00:11<09:25,  5.77s/it]Training:   3%|â–         | 3/100 [00:17<09:19,  5.77s/it]Training:   4%|â–         | 4/100 [00:23<09:14,  5.77s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:08,  5.77s/it]Training:   6%|â–Œ         | 6/100 [00:34<09:02,  5.77s/it]Training:   7%|â–‹         | 7/100 [00:40<08:56,  5.77s/it]Training:   8%|â–Š         | 8/100 [00:46<08:50,  5.77s/it]Training:   9%|â–‰         | 9/100 [00:51<08:44,  5.76s/it]Training:   9%|â–‰         | 9/100 [00:57<08:44,  5.76s/it, loss=3.2997, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:38,  5.76s/it, loss=3.2997, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:03<08:31,  5.75s/it, loss=3.2997, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:09<08:25,  5.75s/it, loss=3.2997, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:20,  5.75s/it, loss=3.2997, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:14,  5.75s/it, loss=3.2997, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:26<08:08,  5.74s/it, loss=3.2997, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:32<08:02,  5.74s/it, loss=3.2997, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:56,  5.74s/it, loss=3.2997, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:43<07:51,  5.74s/it, loss=3.2997, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:49<07:45,  5.74s/it, loss=3.2997, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:55<07:45,  5.74s/it, loss=0.1926, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:55<07:39,  5.74s/it, loss=0.1926, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:33,  5.74s/it, loss=0.1926, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:06<07:27,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:12<07:21,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:15,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:09,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:29<07:04,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:35<06:58,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:52,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:46<06:46,  5.73s/it, loss=0.1926, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:52<06:46,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:52<06:41,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:58<06:35,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:09<06:23,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:15<06:18,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:21<06:12,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:26<06:06,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:32<06:00,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:38<05:55,  5.73s/it, loss=0.1921, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:49,  5.72s/it, loss=0.1921, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:49<05:49,  5.72s/it, loss=0.1776, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:49<05:43,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:55<05:37,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:01<05:32,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:06<05:26,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:12<05:20,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:18<05:14,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:24<05:09,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:29<05:03,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:35<04:57,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:41<04:51,  5.73s/it, loss=0.1776, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:51,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:46,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:52<04:40,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:58<04:35,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:04<04:29,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:09<04:23,  5.74s/it, loss=0.1660, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:15<04:18,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:21<04:12,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:27<04:06,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:32<04:00,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:38<03:54,  5.73s/it, loss=0.1660, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:44<03:54,  5.73s/it, loss=0.2132, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:44<03:49,  5.73s/it, loss=0.2132, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:49<03:43,  5.72s/it, loss=0.2132, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:55<03:37,  5.72s/it, loss=0.2132, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:01<03:31,  5.72s/it, loss=0.2132, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:07<03:26,  5.73s/it, loss=0.2132, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:12<03:20,  5.73s/it, loss=0.2132, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:18<03:14,  5.73s/it, loss=0.2132, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:24<03:08,  5.72s/it, loss=0.2132, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:30<03:03,  5.73s/it, loss=0.2132, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:35<02:57,  5.73s/it, loss=0.2132, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:41<02:57,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:41<02:52,  5.74s/it, loss=0.1769, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:47<02:46,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:52<02:40,  5.74s/it, loss=0.1769, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:58<02:34,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:04<02:29,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:10<02:23,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:15<02:17,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:21<02:11,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:27<02:06,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:33<02:00,  5.73s/it, loss=0.1769, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:38<02:00,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:38<01:54,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:44<01:48,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:50<01:43,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:55<01:37,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:01<01:31,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:07<01:25,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:13<01:20,  5.72s/it, loss=0.1692, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:18<01:14,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:24<01:08,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:30<01:03,  5.73s/it, loss=0.1692, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:36<01:03,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:36<00:57,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:41<00:51,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:47<00:45,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:53<00:40,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:58<00:34,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:04<00:28,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:10<00:22,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:16<00:17,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:21<00:11,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:27<00:05,  5.73s/it, loss=0.1808, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:33<00:05,  5.73s/it, loss=0.1417, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:34<00:00,  5.94s/it, loss=0.1417, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:34<00:00,  5.74s/it, loss=0.1417, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_C/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 11.3415
ğŸ“‰ Final loss: 0.0356
ğŸ“‰ Loss reduction: 99.69%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_C/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 11.3415 â†’ 0.0356
   - Improvement: 99.69%
   - Samples: 2,959

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


ğŸ¤– AGENTIC AGGREGATION

ğŸ“Š Round 1 Summary:
   Global Avg Loss: 0.1734
   Client Losses: ['0.4380', '0.3786', '0.0356']
   Agent Weights: ['0.182', '0.189', '0.630']

======================================================================
ğŸ”„ ROUND 2/5
======================================================================

--- Client 1/3: hospital_A ---

============================================================
ğŸ¥ CLIENT: hospital_A
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 4520 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_A

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:26,  5.72s/it]Training:   2%|â–         | 2/100 [00:11<09:20,  5.72s/it]Training:   3%|â–         | 3/100 [00:17<09:15,  5.72s/it]Training:   4%|â–         | 4/100 [00:22<09:09,  5.73s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:04,  5.73s/it]Training:   6%|â–Œ         | 6/100 [00:34<08:58,  5.73s/it]Training:   7%|â–‹         | 7/100 [00:40<08:53,  5.73s/it]Training:   8%|â–Š         | 8/100 [00:45<08:47,  5.73s/it]Training:   9%|â–‰         | 9/100 [00:51<08:42,  5.74s/it]Training:   9%|â–‰         | 9/100 [00:57<08:42,  5.74s/it, loss=0.1998, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:37,  5.75s/it, loss=0.1998, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:03<08:31,  5.74s/it, loss=0.1998, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:08<08:25,  5.74s/it, loss=0.1998, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:18,  5.73s/it, loss=0.1998, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:12,  5.73s/it, loss=0.1998, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:25<08:06,  5.72s/it, loss=0.1998, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:31<08:00,  5.72s/it, loss=0.1998, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:54,  5.72s/it, loss=0.1998, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:43<07:49,  5.72s/it, loss=0.1998, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:48<07:43,  5.72s/it, loss=0.1998, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:54<07:43,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:54<07:37,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:31,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:05<07:26,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:11<07:20,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:14,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:09,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:28<07:03,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:34<06:57,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:51,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:46<06:45,  5.72s/it, loss=0.1386, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:51<06:45,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:51<06:40,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:57<06:34,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:08<06:23,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:14<06:17,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:20<06:12,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:26<06:06,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:31<06:00,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:37<05:54,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:48,  5.72s/it, loss=0.2066, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:48<05:48,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:48<05:42,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:54<05:37,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:00<05:31,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:06<05:25,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:11<05:20,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:17<05:14,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:23<05:09,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:28<05:03,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:34<04:57,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:40<04:51,  5.72s/it, loss=0.1811, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:51,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:46,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:51<04:40,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:57<04:34,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:03<04:28,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:09<04:23,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:14<04:17,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:20<04:11,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:26<04:05,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:31<04:00,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:37<03:54,  5.72s/it, loss=0.1758, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:43<03:54,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:43<03:48,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:49<03:43,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:54<03:37,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:00<03:31,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:06<03:25,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:11<03:20,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:17<03:14,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:23<03:08,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:29<03:03,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:34<02:57,  5.72s/it, loss=0.2205, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:40<02:57,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:40<02:51,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:46<02:45,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:52<02:40,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:57<02:34,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:03<02:28,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:09<02:22,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:14<02:17,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:20<02:11,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:26<02:05,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:32<02:00,  5.72s/it, loss=0.1893, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:37<02:00,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:37<01:54,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:43<01:48,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:49<01:43,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:54<01:37,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:00<01:31,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:06<01:25,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:12<01:20,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:17<01:14,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:23<01:08,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:29<01:02,  5.72s/it, loss=0.1807, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:34<01:02,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:34<00:57,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:40<00:51,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:46<00:45,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:52<00:40,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:57<00:34,  5.73s/it, loss=0.1412, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:03<00:28,  5.73s/it, loss=0.1412, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:09<00:22,  5.73s/it, loss=0.1412, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:15<00:17,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:20<00:11,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:26<00:05,  5.72s/it, loss=0.1412, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:32<00:05,  5.72s/it, loss=0.1778, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.94s/it, loss=0.1778, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.73s/it, loss=0.1778, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_A/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 0.3082
ğŸ“‰ Final loss: 0.1276
ğŸ“‰ Loss reduction: 58.60%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_A/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 0.3082 â†’ 0.1276
   - Improvement: 58.60%
   - Samples: 4,520

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


--- Client 2/3: hospital_B ---

============================================================
ğŸ¥ CLIENT: hospital_B
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 2521 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_B

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:25,  5.72s/it]Training:   2%|â–         | 2/100 [00:11<09:20,  5.72s/it]Training:   3%|â–         | 3/100 [00:17<09:14,  5.72s/it]Training:   4%|â–         | 4/100 [00:22<09:09,  5.72s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:03,  5.72s/it]Training:   6%|â–Œ         | 6/100 [00:34<08:57,  5.72s/it]Training:   7%|â–‹         | 7/100 [00:40<08:52,  5.72s/it]Training:   8%|â–Š         | 8/100 [00:45<08:46,  5.72s/it]Training:   9%|â–‰         | 9/100 [00:51<08:40,  5.72s/it]Training:   9%|â–‰         | 9/100 [00:57<08:40,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:34,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:02<08:29,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:08<08:23,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:17,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:12,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:25<08:06,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:31<08:00,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:54,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:42<07:49,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:48<07:43,  5.72s/it, loss=0.1381, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:54<07:43,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:54<07:37,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:31,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:05<07:26,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:11<07:20,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:14,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:09,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:28<07:03,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:34<06:57,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:52,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:45<06:46,  5.72s/it, loss=0.1612, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:51<06:46,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:51<06:40,  5.73s/it, loss=0.1765, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:57<06:34,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:08<06:23,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:14<06:17,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:20<06:11,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:25<06:06,  5.73s/it, loss=0.1765, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:31<06:00,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:37<05:54,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:49,  5.72s/it, loss=0.1765, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:48<05:49,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:48<05:43,  5.73s/it, loss=0.2149, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:54<05:37,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:00<05:31,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:05<05:25,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:11<05:20,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:17<05:14,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:23<05:08,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:28<05:03,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:34<04:57,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:40<04:51,  5.72s/it, loss=0.2149, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:51,  5.72s/it, loss=0.1505, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:45,  5.72s/it, loss=0.1505, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:51<04:40,  5.72s/it, loss=0.1505, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:57<04:34,  5.72s/it, loss=0.1505, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:03<04:28,  5.72s/it, loss=0.1505, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:08<04:23,  5.72s/it, loss=0.1505, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:14<04:17,  5.73s/it, loss=0.1505, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:20<04:12,  5.73s/it, loss=0.1505, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:26<04:06,  5.73s/it, loss=0.1505, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:31<04:00,  5.73s/it, loss=0.1505, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:37<03:54,  5.73s/it, loss=0.1505, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:43<03:54,  5.73s/it, loss=0.1072, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:43<03:49,  5.73s/it, loss=0.1072, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:49<03:43,  5.73s/it, loss=0.1072, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:54<03:37,  5.73s/it, loss=0.1072, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:00<03:32,  5.74s/it, loss=0.1072, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:06<03:26,  5.74s/it, loss=0.1072, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:11<03:20,  5.73s/it, loss=0.1072, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:17<03:14,  5.73s/it, loss=0.1072, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:23<03:08,  5.72s/it, loss=0.1072, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:29<03:03,  5.72s/it, loss=0.1072, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:34<02:57,  5.72s/it, loss=0.1072, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:40<02:57,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:40<02:51,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:46<02:45,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:51<02:40,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:57<02:34,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:03<02:28,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:09<02:23,  5.73s/it, loss=0.1965, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:14<02:17,  5.73s/it, loss=0.1965, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:20<02:11,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:26<02:05,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:32<02:00,  5.72s/it, loss=0.1965, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:37<02:00,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:37<01:54,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:43<01:48,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:49<01:42,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:54<01:37,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:00<01:31,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:06<01:25,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:12<01:20,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:17<01:14,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:23<01:08,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:29<01:02,  5.72s/it, loss=0.1855, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:34<01:02,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:34<00:57,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:40<00:51,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:46<00:45,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:52<00:40,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:57<00:34,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:03<00:28,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:09<00:22,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:14<00:17,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:20<00:11,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:26<00:05,  5.72s/it, loss=0.1445, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:32<00:05,  5.72s/it, loss=0.1440, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.92s/it, loss=0.1440, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.73s/it, loss=0.1440, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_B/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 0.1867
ğŸ“‰ Final loss: 0.0420
ğŸ“‰ Loss reduction: 77.52%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_B/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 0.1867 â†’ 0.0420
   - Improvement: 77.52%
   - Samples: 2,521

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


--- Client 3/3: hospital_C ---

============================================================
ğŸ¥ CLIENT: hospital_C
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 2959 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_C

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:26,  5.72s/it]Training:   2%|â–         | 2/100 [00:11<09:21,  5.73s/it]Training:   3%|â–         | 3/100 [00:17<09:15,  5.72s/it]Training:   4%|â–         | 4/100 [00:22<09:09,  5.73s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:04,  5.73s/it]Training:   6%|â–Œ         | 6/100 [00:34<08:58,  5.73s/it]Training:   7%|â–‹         | 7/100 [00:40<08:53,  5.73s/it]Training:   8%|â–Š         | 8/100 [00:45<08:47,  5.73s/it]Training:   9%|â–‰         | 9/100 [00:51<08:41,  5.73s/it]Training:   9%|â–‰         | 9/100 [00:57<08:41,  5.73s/it, loss=0.1554, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:35,  5.73s/it, loss=0.1554, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:03<08:29,  5.73s/it, loss=0.1554, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:08<08:23,  5.73s/it, loss=0.1554, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:17,  5.72s/it, loss=0.1554, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:12,  5.72s/it, loss=0.1554, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:25<08:06,  5.72s/it, loss=0.1554, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:31<08:00,  5.72s/it, loss=0.1554, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:54,  5.72s/it, loss=0.1554, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:43<07:48,  5.72s/it, loss=0.1554, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:48<07:43,  5.72s/it, loss=0.1554, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:54<07:43,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:54<07:37,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:31,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:05<07:26,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:11<07:20,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:14,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:08,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:28<07:02,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:34<06:57,  5.72s/it, loss=0.1720, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:51,  5.71s/it, loss=0.1720, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:45<06:45,  5.71s/it, loss=0.1720, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:51<06:45,  5.71s/it, loss=0.1176, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:51<06:40,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:57<06:34,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:28,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:08<06:23,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:14<06:17,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:20<06:11,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:25<06:05,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:31<06:00,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:37<05:54,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:48,  5.72s/it, loss=0.1176, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:48<05:48,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:48<05:43,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:54<05:37,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:00<05:31,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:05<05:25,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:11<05:20,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:17<05:14,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:23<05:08,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:28<05:03,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:34<04:57,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:40<04:51,  5.72s/it, loss=0.1406, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:51,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:45,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:51<04:40,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:57<04:34,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:03<04:28,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:08<04:23,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:14<04:17,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:20<04:11,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:26<04:05,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:31<04:00,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:37<03:54,  5.72s/it, loss=0.1566, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:43<03:54,  5.72s/it, loss=0.1707, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:43<03:49,  5.73s/it, loss=0.1707, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:48<03:43,  5.73s/it, loss=0.1707, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:54<03:37,  5.72s/it, loss=0.1707, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:00<03:31,  5.72s/it, loss=0.1707, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:06<03:25,  5.72s/it, loss=0.1707, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:11<03:20,  5.72s/it, loss=0.1707, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:17<03:14,  5.73s/it, loss=0.1707, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:23<03:08,  5.73s/it, loss=0.1707, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:29<03:03,  5.73s/it, loss=0.1707, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:34<02:57,  5.73s/it, loss=0.1707, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:40<02:57,  5.73s/it, loss=0.2189, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:40<02:51,  5.73s/it, loss=0.2189, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:46<02:46,  5.73s/it, loss=0.2189, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:51<02:40,  5.72s/it, loss=0.2189, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:57<02:34,  5.72s/it, loss=0.2189, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:03<02:28,  5.72s/it, loss=0.2189, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:09<02:23,  5.73s/it, loss=0.2189, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:14<02:17,  5.72s/it, loss=0.2189, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:20<02:11,  5.72s/it, loss=0.2189, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:26<02:05,  5.72s/it, loss=0.2189, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:31<02:00,  5.72s/it, loss=0.2189, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:37<02:00,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:37<01:54,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:43<01:48,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:49<01:43,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:54<01:37,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:00<01:31,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:06<01:25,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:12<01:20,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:17<01:14,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:23<01:08,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:29<01:02,  5.72s/it, loss=0.1845, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:34<01:02,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:34<00:57,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:40<00:51,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:46<00:45,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:52<00:40,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:57<00:34,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:03<00:28,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:09<00:22,  5.73s/it, loss=0.1766, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:15<00:17,  5.72s/it, loss=0.1766, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:20<00:11,  5.73s/it, loss=0.1766, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:26<00:05,  5.73s/it, loss=0.1766, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:32<00:05,  5.73s/it, loss=0.1845, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.93s/it, loss=0.1845, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.73s/it, loss=0.1845, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_C/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 0.2585
ğŸ“‰ Final loss: 0.0471
ğŸ“‰ Loss reduction: 81.80%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_C/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 0.2585 â†’ 0.0471
   - Improvement: 81.80%
   - Samples: 2,959

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


ğŸ¤– AGENTIC AGGREGATION

ğŸ“Š Round 2 Summary:
   Global Avg Loss: 0.0685
   Client Losses: ['0.1276', '0.0420', '0.0471']
   Agent Weights: ['0.288', '0.355', '0.357']

======================================================================
ğŸ”„ ROUND 3/5
======================================================================

--- Client 1/3: hospital_A ---

============================================================
ğŸ¥ CLIENT: hospital_A
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 4520 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_A

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:25,  5.71s/it]Training:   2%|â–         | 2/100 [00:11<09:20,  5.72s/it]Training:   3%|â–         | 3/100 [00:17<09:15,  5.72s/it]Training:   4%|â–         | 4/100 [00:22<09:09,  5.72s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:03,  5.72s/it]Training:   6%|â–Œ         | 6/100 [00:34<08:57,  5.72s/it]Training:   7%|â–‹         | 7/100 [00:40<08:52,  5.72s/it]Training:   8%|â–Š         | 8/100 [00:45<08:46,  5.72s/it]Training:   9%|â–‰         | 9/100 [00:51<08:40,  5.72s/it]Training:   9%|â–‰         | 9/100 [00:57<08:40,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:35,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:02<08:29,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:08<08:23,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:17,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:12,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:25<08:06,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:31<08:00,  5.73s/it, loss=0.1829, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:55,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:43<07:49,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:48<07:43,  5.72s/it, loss=0.1829, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:54<07:43,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:54<07:37,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:31,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:05<07:26,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:11<07:20,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:15,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:09,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:28<07:03,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:34<06:57,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:51,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:45<06:46,  5.72s/it, loss=0.1896, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:51<06:46,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:51<06:40,  5.73s/it, loss=0.1771, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:57<06:35,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:08<06:23,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:14<06:17,  5.73s/it, loss=0.1771, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:20<06:11,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:26<06:06,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:31<06:00,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:37<05:54,  5.72s/it, loss=0.1771, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:49,  5.73s/it, loss=0.1771, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:48<05:49,  5.73s/it, loss=0.1678, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:48<05:43,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:54<05:37,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:00<05:31,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:06<05:25,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:11<05:20,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:17<05:14,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:23<05:08,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:28<05:03,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:34<04:57,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:40<04:51,  5.72s/it, loss=0.1678, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:51,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:46,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:51<04:40,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:57<04:34,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:03<04:28,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:08<04:23,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:14<04:17,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:20<04:11,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:26<04:05,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:31<04:00,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:37<03:54,  5.72s/it, loss=0.1663, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:43<03:54,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:43<03:48,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:49<03:43,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:54<03:37,  5.73s/it, loss=0.2102, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:00<03:31,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:06<03:26,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:11<03:20,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:17<03:14,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:23<03:08,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:29<03:03,  5.73s/it, loss=0.2102, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:34<02:57,  5.72s/it, loss=0.2102, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:40<02:57,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:40<02:51,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:46<02:45,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:51<02:40,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:57<02:34,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:03<02:28,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:09<02:23,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:14<02:17,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:20<02:11,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:26<02:05,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:32<02:00,  5.72s/it, loss=0.1562, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:37<02:00,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:37<01:54,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:43<01:48,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:49<01:42,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:54<01:37,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:00<01:31,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:06<01:25,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:12<01:20,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:17<01:14,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:23<01:08,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:29<01:02,  5.72s/it, loss=0.1754, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:34<01:02,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:34<00:57,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:40<00:51,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:46<00:45,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:52<00:40,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:57<00:34,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:03<00:28,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:09<00:22,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:15<00:17,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:20<00:11,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:26<00:05,  5.72s/it, loss=0.1437, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:32<00:05,  5.72s/it, loss=0.1568, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.94s/it, loss=0.1568, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.73s/it, loss=0.1568, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_A/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 0.0375
ğŸ“‰ Final loss: 0.3217
ğŸ“‰ Loss reduction: -757.13%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_A/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 0.0375 â†’ 0.3217
   - Improvement: -757.13%
   - Samples: 4,520

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


--- Client 2/3: hospital_B ---

============================================================
ğŸ¥ CLIENT: hospital_B
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 2521 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_B

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:26,  5.73s/it]Training:   2%|â–         | 2/100 [00:11<09:21,  5.73s/it]Training:   3%|â–         | 3/100 [00:17<09:15,  5.73s/it]Training:   4%|â–         | 4/100 [00:22<09:09,  5.72s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:03,  5.72s/it]Training:   6%|â–Œ         | 6/100 [00:34<08:57,  5.72s/it]Training:   7%|â–‹         | 7/100 [00:40<08:51,  5.72s/it]Training:   8%|â–Š         | 8/100 [00:45<08:46,  5.73s/it]Training:   9%|â–‰         | 9/100 [00:51<08:41,  5.73s/it]Training:   9%|â–‰         | 9/100 [00:57<08:41,  5.73s/it, loss=0.1910, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:35,  5.73s/it, loss=0.1910, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:02<08:29,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:08<08:23,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:17,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:11,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:25<08:06,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:31<08:00,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:54,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:42<07:49,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:48<07:43,  5.72s/it, loss=0.1910, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:54<07:43,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:54<07:37,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:32,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:05<07:26,  5.73s/it, loss=0.1373, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:11<07:20,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:15,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:09,  5.73s/it, loss=0.1373, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:28<07:03,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:34<06:57,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:51,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:45<06:46,  5.72s/it, loss=0.1373, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:51<06:46,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:51<06:40,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:57<06:34,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:08<06:23,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:14<06:17,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:20<06:11,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:26<06:06,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:31<06:00,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:37<05:54,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:48,  5.72s/it, loss=0.1561, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:48<05:48,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:48<05:43,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:54<05:37,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:00<05:31,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:06<05:26,  5.73s/it, loss=0.1249, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:11<05:20,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:17<05:14,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:23<05:08,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:28<05:03,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:34<04:57,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:40<04:51,  5.72s/it, loss=0.1249, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:51,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:46,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:51<04:40,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:57<04:34,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:03<04:28,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:08<04:23,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:14<04:17,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:20<04:11,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:26<04:06,  5.73s/it, loss=0.1702, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:31<04:00,  5.73s/it, loss=0.1702, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:37<03:54,  5.72s/it, loss=0.1702, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:43<03:54,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:43<03:49,  5.73s/it, loss=0.1744, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:49<03:43,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:54<03:37,  5.73s/it, loss=0.1744, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:00<03:31,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [06:06<03:25,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [06:11<03:20,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [06:17<03:14,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [06:23<03:08,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [06:29<03:03,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:34<02:57,  5.72s/it, loss=0.1744, vram=5.02GB]Training:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [06:40<02:57,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [06:40<02:51,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [06:46<02:45,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [06:52<02:40,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 73/100 [06:57<02:34,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [07:03<02:28,  5.73s/it, loss=0.1528, vram=5.02GB]Training:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [07:09<02:23,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [07:14<02:17,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [07:20<02:11,  5.72s/it, loss=0.1528, vram=5.02GB]Training:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [07:26<02:06,  5.73s/it, loss=0.1528, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:32<02:00,  5.73s/it, loss=0.1528, vram=5.02GB]Training:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [07:37<02:00,  5.73s/it, loss=0.1977, vram=5.02GB]Training:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [07:37<01:54,  5.73s/it, loss=0.1977, vram=5.02GB]Training:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [07:43<01:48,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [07:49<01:43,  5.73s/it, loss=0.1977, vram=5.02GB]Training:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 83/100 [07:54<01:37,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [08:00<01:31,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [08:06<01:25,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [08:12<01:20,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [08:17<01:14,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [08:23<01:08,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:29<01:02,  5.72s/it, loss=0.1977, vram=5.02GB]Training:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [08:35<01:02,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [08:35<00:57,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [08:40<00:51,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [08:46<00:45,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 93/100 [08:52<00:40,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [08:57<00:34,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [09:03<00:28,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [09:09<00:22,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [09:15<00:17,  5.72s/it, loss=0.1311, vram=5.02GB]Training:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [09:20<00:11,  5.73s/it, loss=0.1311, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:26<00:05,  5.73s/it, loss=0.1311, vram=5.02GB]Training:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [09:32<00:05,  5.73s/it, loss=0.1705, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.94s/it, loss=0.1705, vram=5.02GB]Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [09:32<00:00,  5.73s/it, loss=0.1705, vram=5.02GB]

ğŸ’¾ Checkpoint saved: output-models/federated/hospital_B/checkpoint-100

============================================================
âœ… Training complete!
============================================================
ğŸ“‰ Initial loss: 0.2991
ğŸ“‰ Final loss: 0.0416
ğŸ“‰ Loss reduction: 86.09%
ğŸ’¾ Peak VRAM: 5.02 GB
ğŸ’¾ Model saved: output-models/federated/hospital_B/final
============================================================


ğŸ“Š Training metrics:
   - Loss: 0.2991 â†’ 0.0416
   - Improvement: 86.09%
   - Samples: 2,521

ğŸ“¤ Transmission:
   - LoRA params: 3,407,872
   - Size: 13.00 MB
============================================================


--- Client 3/3: hospital_C ---

============================================================
ğŸ¥ CLIENT: hospital_C
============================================================
âœ… Loaded global LoRA parameters (128 tensors)
ğŸ”„ Starting local training (100 steps)...
ğŸš€ Starting local training...
   Dataset: 2959 samples
   Steps: 100
   Batch size: 2
   Learning rate: 0.0002
   Output dir: output-models/federated/hospital_C

Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:05<09:25,  5.71s/it]Training:   2%|â–         | 2/100 [00:11<09:20,  5.72s/it]Training:   3%|â–         | 3/100 [00:17<09:14,  5.72s/it]Training:   4%|â–         | 4/100 [00:22<09:09,  5.72s/it]Training:   5%|â–Œ         | 5/100 [00:28<09:03,  5.72s/it]Training:   6%|â–Œ         | 6/100 [00:34<08:57,  5.72s/it]Training:   7%|â–‹         | 7/100 [00:40<08:51,  5.72s/it]Training:   8%|â–Š         | 8/100 [00:45<08:46,  5.72s/it]Training:   9%|â–‰         | 9/100 [00:51<08:40,  5.72s/it]Training:   9%|â–‰         | 9/100 [00:57<08:40,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  10%|â–ˆ         | 10/100 [00:57<08:34,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  11%|â–ˆ         | 11/100 [01:02<08:28,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  12%|â–ˆâ–        | 12/100 [01:08<08:23,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  13%|â–ˆâ–        | 13/100 [01:14<08:17,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  14%|â–ˆâ–        | 14/100 [01:20<08:12,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  15%|â–ˆâ–Œ        | 15/100 [01:25<08:06,  5.73s/it, loss=0.1556, vram=5.02GB]Training:  16%|â–ˆâ–Œ        | 16/100 [01:31<08:00,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  17%|â–ˆâ–‹        | 17/100 [01:37<07:55,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  18%|â–ˆâ–Š        | 18/100 [01:42<07:49,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:48<07:43,  5.72s/it, loss=0.1556, vram=5.02GB]Training:  19%|â–ˆâ–‰        | 19/100 [01:54<07:43,  5.72s/it, loss=0.2017, vram=5.02GB]Training:  20%|â–ˆâ–ˆ        | 20/100 [01:54<07:37,  5.72s/it, loss=0.2017, vram=5.02GB]Training:  21%|â–ˆâ–ˆ        | 21/100 [02:00<07:32,  5.73s/it, loss=0.2017, vram=5.02GB]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [02:05<07:26,  5.73s/it, loss=0.2017, vram=5.02GB]Training:  23%|â–ˆâ–ˆâ–       | 23/100 [02:11<07:20,  5.73s/it, loss=0.2017, vram=5.02GB]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [02:17<07:15,  5.73s/it, loss=0.2017, vram=5.02GB]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [02:23<07:09,  5.73s/it, loss=0.2017, vram=5.02GB]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [02:28<07:03,  5.73s/it, loss=0.2017, vram=5.02GB]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [02:34<06:57,  5.72s/it, loss=0.2017, vram=5.02GB]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [02:40<06:52,  5.72s/it, loss=0.2017, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:45<06:46,  5.73s/it, loss=0.2017, vram=5.02GB]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [02:51<06:46,  5.73s/it, loss=0.2101, vram=5.02GB]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [02:51<06:40,  5.73s/it, loss=0.2101, vram=5.02GB]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [02:57<06:35,  5.73s/it, loss=0.2101, vram=5.02GB]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [03:03<06:29,  5.73s/it, loss=0.2101, vram=5.02GB]Training:  33%|â–ˆâ–ˆâ–ˆâ–      | 33/100 [03:08<06:23,  5.72s/it, loss=0.2101, vram=5.02GB]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [03:14<06:17,  5.72s/it, loss=0.2101, vram=5.02GB]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [03:20<06:11,  5.72s/it, loss=0.2101, vram=5.02GB]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [03:26<06:05,  5.72s/it, loss=0.2101, vram=5.02GB]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [03:31<06:00,  5.72s/it, loss=0.2101, vram=5.02GB]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [03:37<05:54,  5.72s/it, loss=0.2101, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:43<05:48,  5.72s/it, loss=0.2101, vram=5.02GB]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [03:48<05:48,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [03:48<05:43,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [03:54<05:37,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [04:00<05:31,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/100 [04:06<05:25,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [04:11<05:20,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [04:17<05:14,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [04:23<05:08,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [04:28<05:03,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [04:34<04:57,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:40<04:51,  5.72s/it, loss=0.1212, vram=5.02GB]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [04:46<04:51,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [04:46<04:46,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [04:51<04:40,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [04:57<04:34,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 53/100 [05:03<04:28,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [05:08<04:23,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [05:14<04:17,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [05:20<04:11,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [05:26<04:05,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [05:31<04:00,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:37<03:54,  5.72s/it, loss=0.1413, vram=5.02GB]Training:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [05:43<03:54,  5.72s/it, loss=0.1110, vram=5.02GB]Training:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [05:43<03:48,  5.72s/it, loss=0.1110, vram=5.02GB]Training:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [05:49<03:43,  5.72s/it, loss=0.1110, vram=5.02GB]Training:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [05:54<03:37,  5.72s/it, loss=0.1110, vram=5.02GB]Training:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 63/100 [06:00<03:31,  5.72s/it, loss=0.1110, vram=5.02GB]